Platform : Teleinfo
===================

This page last changed on Apr 08, 2011 by gilles.

Protocol overview
=================

Télé-information is available in the ERDF power meters.\
 Télé-information is a permanent flux of information concerning both
contractual parameters and measures.

Teleinfo is a "unsolicited response" protocol type.

The ERDF devices equipped with teleinfo are:

-   "le concentrateur de téléreport",
-   "le compteur « Bleu » électronique monophasé multitarif (CBEMM : 2
    paliers différents)",
-   "le compteur « Bleu » électronique triphasé multitarif (CBETM)",
-   "le compteur « Jaune » électronique (CJE)",
-   "le compteur « Interface Clientèle Emeraude » (ICE)".

Teleinfo: electrical characteristics
------------------------------------

These are the main characteristics of the teleinfo transmission:

-   binary form,
-   unidirectional,
-   1200 bauds +/-1%,
-   '1' duration equal '0' duration
-   amplitude modulation around a 50kHz +/-3% carrier
-   negative logic (carrier is present = '0', no carrier = '1')

Usually (this is actually the case for open AT devices) the teleinfo
transmission is exploited through a RS232 adaptator.

Teleinfo data model
-------------------

The teleinfo data model depends on the ERDF devices.

Protocol implementations
========================

OpenAT Implementation
---------------------

This asynchronous (callback driven) teleinfo stack is initialized
calling the "TELEINFO\_InitContext(TeleinfoContext\*
pTeleinfoContext,...)".

To initialize the stack you have to set the line parameters (mainly,
parity, baudrate, timeout) , the group names, sizes (expected value size
in number of character) and number you want to acquire.

The stack is released by calling
"TELEINFO\_ReleaseContext(TeleinfoContext\* pTeleinfoContext)".

Lua over OpenAT implementation
------------------------------

This implementation is synchronous and thread safe.

The stack can be initialized with default parametres
"t,err=teleinfo.new(nil, nil, {ADCO=12, IINST=4})" , partially
"m,err=teleinfo.new(nil, {baudrate=19200}, {ADCO=12, IINST=4}) " or
fully
"m,err=teleinfo.new('uart2',{baudrate=9600,parity='even',timeout=3},{ADCO=12,
IINST=4})".

The stack is explicitely closed by calling "t:close()".

~~~~ {.theme: .Confluence; .brush: .java; .gutter: .false
style="font-size:12px;"}
t,err=teleinfo.new(portname ,{baudrate=baudrate,parity=parity,data=data,stop=stop},{ADCO=12,PTEC=4,BASE=12,IINST=5});p(err)
resul_table,err=t:read("ADCO","PTEC","IINST")
~~~~

The stack can accept at initialization time either a table or a
function.\
 The table will be refreshed and the function will be called each time a
valid frame is received.

~~~~ {.theme: .Confluence; .brush: .java; .gutter: .false
style="font-size:12px;"}
--initialization with table
teleinfo_table = {}
t,err=teleinfo.new(portname ,{baudrate=baudrate,parity=parity,data=data,stop=stop},{ADCO=12,PTEC=4,BASE=12,IINST=5}, teleinfo_table)

--initialization with function
function teleinfo_func(t_table) print('BASE', t_table.BASE) end
t,err=teleinfo.new(portname ,{baudrate=baudrate,parity=parity,data=data,stop=stop},{ADCO=12,PTEC=4,BASE=12,IINST=5}, teleinfo_func)
~~~~

Document generated by Confluence on Mar 11, 2013 16:17
